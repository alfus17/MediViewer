	<!DOCTYPE html>
	<html xmlns:th="http://www.thymeleaf.org">
	<head>
	    <meta charset="UTF-8">
	    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	    <title>Stack Manipulation Tools</title>
	    <link rel="stylesheet" href="/css/view.css">
	    <link rel="stylesheet" href="/css/viewModal.css">
	</head>
	<body class="vbody">
	
	        <div class="left">
				<img src="/img/viewIcon/KakaoTalk_20241025_124436798.png" id="mainImg">
	            <div id="thumbnailContainer"></div>
	        </div>   
	
	        <div class="right">
	            <div class="btns">
	                <button id="hFlip">
						<img src="/img/viewIcon/swap_horiz_16dp_FF6347_FILL0_wght400_GRAD0_opsz20.png">
						<span>좌우반전</span>
					</button>
					
	                <button id="invert">
						<img src="/img/viewIcon/invert_colors_16dp_FF6347_FILL0_wght400_GRAD0_opsz20.png">
						<span>흑백전환</span>
					</button>
	                
	               <button id="zoom">
						<img src="/img/viewIcon/pan_zoom_16dp_FF6347_FILL0_wght400_GRAD0_opsz20.png">
						<span>확대축소</span>
					</button>
	                
	               <button id="window-level">
					    <img src="/img/viewIcon/light_mode_16dp_FF6347_FILL0_wght400_GRAD0_opsz20.png">
					    <span>윈도우레벨</span>
					</button>
					<div id="renderBarContainer">
					    <input type="range" id="renderBar" min="0" max="100" value="50">
					    <span id="renderValue">50</span>
					</div>
					
					<button id="play">
						<img src="/img/viewIcon/play_arrow_16dp_FF6347_FILL0_wght400_GRAD0_opsz20.png">
						<span>플레이클립</span>
					</button>
					
					<button id="series">
						<img src="/img/viewIcon/view_compact_alt_16dp_ FF6347_FILL0_wght400_GRAD0_opsz20.png">
						<span>시리즈</span>
					</button>
					
					
					
					<!-- 코멘트 버튼 -->
					<button id="comment">
					    <img src="/img/viewIcon/quick_reference_all_16dp_ FF6347_FILL0_wght400_GRAD0_opsz20.png">
					    <span>코멘트</span>
					</button>
					
					<!-- 모달창 -->
					<div class="modal-overlay" id="commentModal">
					    <div class="modal-content">
					        <span class="close-btn" id="closeModal">&times;</span>
					        <div id="commentModalContent">
							    <h2>Comment: <span th:text="${studyKey}"></span></h2>
							    <textarea id="commentText"></textarea>
							    <button id="saveComment">저장</button>
							</div>
					    </div>
					</div>

					
	                <button id="reset">
						<img src="/img/viewIcon/reset_image_16dp_FF6347_FILL0_wght400_GRAD0_opsz20.png">
						<span>초기화</span>
					</button>
					
					
	            </div>
	            
	            <div class="dicomImage-wrap">
				    <div id="dicomImage" class="dicomImage" style="display: block; margin-top: 20px;"></div> <!-- 초기 display: block 설정 -->
				    <div id="seriesImage" class="seriesImage" style="display: none; margin-top: 20px;"></div> <!-- 초기 display: none 설정 -->
				</div>

	
	
	</body>
	    <script src="https://unpkg.com/cornerstone-core@2.3.0/dist/cornerstone.min.js"></script>
	    <script src="https://unpkg.com/cornerstone-tools@6.0.10/dist/cornerstoneTools.min.js"></script>
	    <script src="https://unpkg.com/cornerstone-wado-image-loader@3.0.0/dist/cornerstoneWADOImageLoader.min.js"></script>
	    <script src="https://unpkg.com/dicom-parser@1.8.5/dist/dicomParser.min.js"></script>
	    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	   <script src="/js/stackImgLoad.js"></script>
	   <script src="/js/easyButton.js"></script>
	   <script src="/js/zoomButton.js"></script>
	   <script src="/js/playClipButton.js"></script>
	   <script src="/js/windowLevelButton.js"></script>
	   <script src="/js/series.js"></script>
	   <script src="/js/comment.js"></script>
	
	  <script>
		let studyKey;
	    const series = [];
	    const dcmPathLists = [];
	    const thumbnails = [];
	    let element; // 이미지데이터
		let imageIds = []; // 이미지들의 배열
		let currentIndex = 0; // 현재 시리즈 인덱스
		let isDragging = false; // 드래그 중인지 여부
		let lastMousePosition = { x: 0, y: 0 }; // 마지막 마우스 위치
		let currentImageIndex = 0; // 현재 이미지 인덱스
		let dcmList = { imageFileNames: [] }; // dcmList 변수 추가
		let serieskey;
		let viewports = []; // 뷰포트를 저장할 배열
		let comment = {};
		
		window.onload = () => {
			start();
			$("#mainImg").click(() => {window.location.href = '/';});
    		registerMouseEvents();  // 마우스 이벤트 등록
			
		}
		
		console.log('스터디키값 확인',studyKey);
	</script>
	
	   
	
	</html>